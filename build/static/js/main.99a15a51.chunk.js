(this["webpackJsonpreact-comments"]=this["webpackJsonpreact-comments"]||[]).push([[0],{64:function(e,n,t){},70:function(e,n,t){"use strict";t.r(n);var c=t(6),r=t(0),i=t.n(r),a=t(9),o=t.n(a),u=(t(64),t(45)),s=t(25),l=t(116),d=t(115),m=t(117),f=t(104),j=t(106),b=t(110),O=t(108),h=t(109),p=t(111),v=t(112),x=t(113),g=t(114),y=t(32),C="comments",w="user",N="SET_COMMENTS",S="ADD_COMMENT",E="DELETE_COMMENT",k="LOAD_USER",T="SET_USER",D=t(41),M=t(42),I=function(){function e(){Object(D.a)(this,e),this.storage=window.localStorage}return Object(M.a)(e,[{key:"set",value:function(e,n){this.storage.setItem(e,JSON.stringify(n))}},{key:"get",value:function(e){var n=this.storage.getItem(e);return n?JSON.parse(n):null}}]),e}(),R=new I;function U(e,n){return function(t,c){var r=c().comments.slice();t(function(e){return{type:S,newComment:e}}({name:e,text:n,date:Date.now(),id:1e3+r.length,reactions:{up:[],down:[]}})),t(J())}}function _(e,n,t){return function(c,r){var i=r().comments.slice(),a=i.findIndex((function(n){return n.id===e})),o=Object(y.a)({},i[a]);o.reactions=Object(y.a)({},o.reactions),Object.keys(o.reactions).map((function(e){return e.slice()})),function(e,n,t){e.reactions[n].includes(t)?B(e,n,t):function(e,n,t){if(!e.reactions[n].includes(t)){e.reactions[n].push(t),B(e,"up"===n?"down":"up",t)}}(e,n,t)}(o,n,t),i[a]=o,c(L(i)),c(J())}}function F(e){return function(n,t){var c=t().comments.slice(),r=c.findIndex((function(n){return n.id===e}));c.splice(r,1),n({type:E}),n(L(c)),n(J())}}function L(e){return{type:N,comments:e}}function J(){return function(e,n){R.set(C,n().comments)}}function B(e,n,t){var c=e.reactions[n].findIndex((function(e){return e===t}));return c>-1&&e.reactions[n].splice(c,1),e}var W=Object(f.a)({root:{minWidth:275,marginBottom:10},actions:{display:"flex"},delete:{}});var A=Object(s.b)((function(e){return{userName:e.user}}),(function(e){return{addReaction:function(n,t,c){return e(_(n,t,c))},deleteComment:function(n){return e(F(n))}}}))((function(e){var n,t=W(),r=e.comment,i=e.userName;return Object(c.jsxs)(j.a,{className:t.root,variant:"outlined",children:[Object(c.jsxs)(O.a,{children:[Object(c.jsx)(h.a,{variant:"body2",component:"p",children:r.text}),Object(c.jsx)(h.a,{variant:"subtitle2",color:"textSecondary",display:"inline",children:r.name}),"\xa0",Object(c.jsx)(h.a,{variant:"caption",color:"textSecondary",display:"inline",children:(n=r.date,new Date(n).toLocaleString())})]}),Object(c.jsxs)(b.a,{className:t.actions,children:[Object(c.jsx)(p.a,{"aria-label":"down",onClick:function(){return e.addReaction(r.id,"down",i)},disabled:!i||r.name===i,children:Object(c.jsx)(v.a,{color:r.reactions.down.includes(i)?"primary":"inherit"})}),"\xa0(",r.reactions.down.length,")",Object(c.jsx)(p.a,{"aria-label":"up",onClick:function(){return e.addReaction(r.id,"up",i)},disabled:!i||r.name===i,children:Object(c.jsx)(x.a,{color:r.reactions.up.includes(i)?"primary":"inherit"})}),"\xa0(",r.reactions.up.length,")",r.name===i&&Object(c.jsx)(p.a,{"aria-label":"delete",className:t.delete,onClick:function(){return e.deleteComment(r.id)},children:Object(c.jsx)(g.a,{})})]})]})})),P=new I;var q,z=Object(s.b)((function(e){return{comments:e.comments,userName:e.user}}),(function(e){return{initComments:function(){return e((function(e,n){e(L(R.get(C)||[]))}))},addComment:function(n,t){return e(U(n,t))},save:function(){return e(J())},loadUser:function(){return e(function(){var e=P.get(w)||"";return{type:k,user:e}}())},setUserName:function(n){return e(function(e){return P.set(w,e),{type:T,userName:e}}(n))}}}))((function(e){var n=e.comments,t=e.userName,a=i.a.useState(""),o=Object(u.a)(a,2),s=o[0],f=o[1];return Object(r.useEffect)((function(){e.initComments(),e.loadUser()}),[]),Object(c.jsxs)(i.a.Fragment,{children:[Object(c.jsx)(m.a,{my:3,children:n.map((function(e,n){return Object(c.jsx)(A,{comment:e},"comment_".concat(n))}))}),Object(c.jsx)(m.a,{my:3,children:Object(c.jsx)(l.a,{label:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",variant:"outlined",value:t,onChange:function(n){return e.setUserName(n.target.value)}})}),Object(c.jsx)(m.a,{my:3,children:Object(c.jsx)(l.a,{label:"\u0412\u0430\u0448 \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439",multiline:!0,fullWidth:!0,variant:"outlined",value:s,onChange:function(e){return f(e.target.value)}})}),Object(c.jsx)(m.a,{display:"flex",justifyContent:"center",my:3,children:Object(c.jsx)(d.a,{variant:"outlined",onClick:function(){e.addComment(t,s.replace(/(<([^>]+)>)/gm,"")),f("")},disabled:!t||!s,children:"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c"})})]})})),G=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,120)).then((function(n){var t=n.getCLS,c=n.getFID,r=n.getFCP,i=n.getLCP,a=n.getTTFB;t(e),c(e),r(e),i(e),a(e)}))},H=t(16),K=t(43),Q=t(44),V=Object(H.combineReducers)({comments:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=arguments.length>1?arguments[1]:void 0;switch(n.type){case S:return e.push(Object(y.a)({},n.newComment)),e;case N:return n.comments.slice();default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",n=arguments.length>1?arguments[1]:void 0;switch(n.type){case k:return n.user;case T:return n.userName;default:return e}}}),X=(q={},Object(H.createStore)(V,q,Object(K.composeWithDevTools)(Object(H.applyMiddleware)(Q.a))));o.a.render(Object(c.jsx)(i.a.StrictMode,{children:Object(c.jsx)(s.a,{store:X,children:Object(c.jsx)(z,{})})}),document.getElementById("root")),G()}},[[70,1,2]]]);
//# sourceMappingURL=main.99a15a51.chunk.js.map